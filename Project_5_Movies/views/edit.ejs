<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Update Movie Data</title>
    <link rel="stylesheet" href="style.css">

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

    <!-- Font Awesome Icon -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css"
        integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSR7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>
<style>
    .edit_form_main {
        display: flex;
        justify-content: center;
        align-items: center;
        position: fixed;
        top: 0;
        z-index: 5000;
        width: 100%;
        height: 100%;
        text-align: left;


        form {
            width: 50%;
            /* height: 82%; */
            padding-bottom: 20px;
            background: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5));
            border-radius: 10px;
            color: white;
            display: flex;
            flex-direction: column;
            align-items: center;

            .cross_btn {
                width: 100%;
                display: flex;
                justify-content: flex-end;
                align-items: center;

                button {
                    margin: 10px 15px;
                    background: none;
                    font-size: 25px;
                    color: white;
                    border: none;
                }
            }


            .form_flex {
                width: 90%;
                display: flex;
                justify-content: space-between;
                gap: 20px;
                margin-top: 30px;

                .form_left {
                    width: 50%;
                }

                .diff_left {
                    width: 50%;
                    display: flex;
                    justify-content: space-between;
                    gap: 20px;

                    .left {
                        width: 50%;
                    }

                    .right {
                        width: 50%;
                    }
                }

                .form_right {
                    width: 50%;
                }

                .diff_right {
                    display: flex;
                    gap: 20px;
                    justify-content: center;

                    .left {
                        width: 70%;
                    }

                    .right {
                        width: 30%;
                        height: 125px;
                        overflow: hidden;
                        margin-top: -55px;

                        img{
                            height: 100%;
                            width: 100%;
                        }
                    }
                }

                h3 {
                    font-size: 18px;
                }

                input {
                    height: 40px;
                    width: 100%;
                    border: none;
                    overflow: hidden;
                }

                input:focus,
                select:focus {
                    overflow: hidden;
                    border: 1px solid rgb(248, 68, 100);
                    outline: 1px solid rgb(248, 68, 100);
                    border-radius: 5px;
                }

                select {
                    height: 40px;
                    width: 101%;
                }

                .file_input {
                    height: 39px;
                    width: 101%;
                    font-size: 14px;
                    color: inherit;
                    display: flex;
                    justify-content: center;
                    align-items: center;
                    overflow: hidden;
                    background-color: rgb(255, 255, 255);
                    color: black;
                }

                .file_input::-webkit-file-upload-button {
                    height: 100%;
                    border: none;
                    padding: 0px 15px;
                    background-color: rgb(248, 68, 100);
                    color: white;
                }


                .star-rating {
                    height: 40px;
                    display: flex;
                    align-items: center;
                    gap: 10px;
                    cursor: pointer;
                }

                .language_options {
                    display: flex;
                    flex-wrap: wrap;
                    justify-content: center;
                    align-items: center;
                    gap: 20px;

                    h3 {
                        margin-top: 10px;
                    }

                    label {
                        display: flex;
                        flex-wrap: wrap;
                        justify-content: center;
                        align-items: center;
                        gap: 10px;

                        input {
                            height: 20px;
                            width: 20px;
                        }
                    }
                }
            }


            .add_submit {
                height: 45px;
                padding: 0px 20px;
                margin-top: 20px;
                border: none;
                border-radius: 5px;
                background-color: rgb(248, 68, 100);
                color: white;
                font-size: 20px;
                transition: 1s ease-in-out;
            }

            .add_submit:hover {
                border: 2px solid rgb(248, 68, 100);
                color: rgb(248, 68, 100);
                background: none;
            }
        }
    }


    .edit_form_main {
        h1 {
            margin-top: 10px;
            margin-bottom: 30px;
            font-size: 35px;
            color: rgb(248, 68, 100);
        }
    }

    .star {
        font-size: 24px;
        cursor: pointer;
        color: #ccc;
    }

    .star.filled {
        color: gold;
    }
</style>

<body>
    <center>
        <div class="edit_form_main"
            style="background: linear-gradient(rgba(0,0,0,0.5), rgba(0,0,0,0.5), rgba(0,0,0,0.5)), url('<%=data.poster%>'); background-size: 100% 100%; background-repeat: no-repeat;">
            <form action="/updateData" enctype="multipart/form-data" method="post">
                <h1>Update Movie Data</h1>
                <br>
                <input hidden type="text" value="<%= data.id %>" name="id">

                <div class="form_flex" style="margin-top: -10px;">
                    <div class="form_left">
                        <h3>Movie Name</h3>
                        <input required type="text" value="<%= data.name %>" name="name"
                            placeholder="Enter Movie Name...">
                    </div>
                    <div class="form_right diff_right">
                        <div class="left">
                            <h3>Movie Image</h3>
                            <input type="file" name="img" class="file_input">
                        </div>

                        <div class="right">
                            <img src="<%=data.img%>" alt="">
                        </div>
                    </div>
                </div>

                <div class="form_flex">
                    <div class="form_left">
                        <h3>Movie</h3>
                        <input required type="text" value="<%= data.movie %>" name="movie"
                            placeholder="Enter Movie Link...">
                    </div>
                    <div class="form_right">
                        <h3>Movie Poster</h3>
                        <input required type="text" value="<%= data.poster %>" name="poster"
                            placeholder="Enter Poster URL...">
                    </div>
                </div>

                <div class="form_flex">
                    <div class="form_left">
                        <h3>Released Date</h3>
                        <input required type="date"
                            value="<%= data.date ? new Date(data.date).toISOString().split('T')[0] : '' %>" name="date">
                    </div>

                    <div class="form_right">
                        <h3>Movie Category</h3>
                        <select required name="category">
                            <option value="">Select Appropriate Option</option>
                            <option value="Action/Thriller" <%=data.category==='Action/Thriller' ? 'selected' : '' %>
                                >Action/Thriller</option>
                            <option value="Adventure/Animation/Drama" <%=data.category==='Adventure/Animation/Drama'
                                ? 'selected' : '' %>>Adventure/Animation/Drama</option>
                            <option value="Comedy/Drama" <%=data.category==='Comedy/Drama' ? 'selected' : '' %>
                                >Comedy/Drama</option>
                            <option value="Adventure/Animation/Family" <%=data.category==='Adventure/Animation/Family'
                                ? 'selected' : '' %>>Adventure/Animation/Family</option>
                            <option value="Drama/Musical/Romantic" <%=data.category==='Drama/Musical/Romantic'
                                ? 'selected' : '' %>>Drama/Musical/Romantic</option>
                        </select>
                    </div>
                </div>

                <div class="form_flex">
                    <div class="form_left diff_left">
                        <div class="left">
                            <h3>Movie Time Limit</h3>
                            <input required type="text" value="<%= data.time %>" name="time" placeholder="HH:MM:SS">
                        </div>
                        <div class="right">
                            <h3>Movie Vote</h3>
                            <input required type="text" value="<%= data.vote %>" name="vote"
                                placeholder="Enter Vote...">
                        </div>
                    </div>
                    <div class="form_right">
                        <h3>Movie Rating</h3>
                        <div class="star-rating" id="starRating">
                            <% for (let i=1; i <=10; i++) { %>
                                <i class="fa-solid fa-star star <%= i <= data.rate ? 'filled' : '' %>"
                                    data-value="<%= i %>"></i>
                                <% } %>
                        </div>
                        <input type="hidden" name="rate" id="rating" value="<%= data.rate %>">
                    </div>

                </div>

                <div class="form_flex">
                    <div class="language_options">
                        <h3>Select Movie Language</h3>
                        <% const languages=['English', 'Hindi' , 'Spanish' , 'French' , 'Other' ]; %>
                            <% languages.forEach(lang=> { %>
                                <label>
                                    <input type="checkbox" name="language" value="<%= lang %>"
                                        <%=data.language.includes(lang) ? 'checked' : '' %>>
                                    <%= lang %>
                                </label>
                                <% }); %>
                    </div>
                </div>

                <button type="submit" class="add_submit">Update Movie</button>
            </form>
        </div>
    </center>
</body>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        const stars = document.querySelectorAll(".star-rating .star");
        const ratingInput = document.getElementById("rating");

        // Function to set stars based on the selected rating
        function setRating(rating) {
            stars.forEach((star, index) => {
                if (index < rating) {
                    star.classList.add("filled");
                } else {
                    star.classList.remove("filled");
                }
            });
            ratingInput.value = rating; // Update the hidden input value
        }

        // Add click event listener to each star
        stars.forEach(star => {
            star.addEventListener("click", function () {
                const rating = parseInt(this.getAttribute("data-value"), 10);
                setRating(rating); // Set the rating
            });
        });
    });
</script>

</html>